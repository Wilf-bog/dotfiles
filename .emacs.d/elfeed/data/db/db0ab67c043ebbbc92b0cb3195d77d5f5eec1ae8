<span class="Z3988" title="ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc&amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator&amp;rft.type=&amp;rft.format=text&amp;rft.title=Argos PanoptÃ¨s, un outil de supervision&amp;rft.source=Framablog&amp;rft.date=2024-05-06&amp;rft.identifier=https://framablog.org/?p=34780&amp;rft.language=English&amp;rft.subject=Enjeux du numÃ©rique&amp;rft.au="></span><p><em>Pour Framaspace, Framasoft a fait dÃ©velopper un outil de supervision de sites web nommÃ© Argos PanoptÃ¨s (ou juste Argos pour aller plus vite).</em></p>
<p><em>DÃ©veloppÃ© par Alexis MÃ©taireau, dÃ©veloppeur entre autres du gÃ©nÃ©rateur de site statique <a href="https://getpelican.com">Pelican</a>, et de l&rsquo;outil de gestion de dÃ©penses Ã  plusieurs Â«&#160;<a href="https://ihatemoney.org/">I Hate money</a>&#160;Â» (repris dans <a href="https://apps.nextcloud.com/apps/cospend">l&rsquo;app cospend</a> sur Nextcloud), le besoin a Ã©tÃ© dÃ©fini par Luc Didry, l&rsquo;administrateur systÃ¨me de Framasoft. </em></p>
<p><em>Luc et Alexis rÃ©pondent Ã  nos questions dans cet interview, pour plus d&rsquo;information concernant Argos vous pouvez consulter <a href="https://framablog.org/2024/05/16/argos-panoptes-la-supervision-de-sites-web-simple-et-efficace/">l&rsquo;article dÃ©diÃ©</a>.<br />
</em></p>
<p><span id="more-34780"></span></p>
<h3>Bonjour Ã  tous les deux&#160;:) Ici on connaÃ®t dÃ©jÃ  Luc puisque c&rsquo;est notre admin sys prÃ©fÃ©rÃ©, mais Alexis, peux-tu nous dire qui tu es pour le framablog&#160;?</h3>
<p><strong>Alexis&#160;:</strong> Bonjour, Framasoft, et merci pour la discussion&#160;! Et bien, c&rsquo;est parti pour l&rsquo;exercice de la prÃ©sentation alors.</p>
<p>Je suis un dÃ©veloppeur de bientÃ´t 40 ans, intÃ©ressÃ© par les dynamiques collectives, le logiciel libre et la protection des donnÃ©es personnelles, depuis quelques annÃ©es maintenant. Par le passÃ© j&rsquo;ai pu publier et maintenir quelques outils comme Pelican, un gÃ©nÃ©rateur de sites statiques et I hate money, pour gÃ©rer les dÃ©penses partagÃ©es. J&rsquo;ai travaillÃ© quelques annÃ©es pour Mozilla sur la partie synchronisation et chiffrement des donnÃ©es (Firefox Sync, Kinto) et sur quelques autres outils.</p>
<p>J&rsquo;ai quittÃ© le dÃ©veloppement Â«&#160;pro&#160;Â» entre 2018 et 2023. Durant ces annÃ©es j&rsquo;ai eu la chance / le privilÃ¨ge de pouvoir monter une brasserie sur Rennes avec un ami. Nous avons essayÃ© de faire vivre les valeurs de la collaboration (plutÃ´t que celles de la compÃ©tition). Cela est restÃ© trÃ¨s proche des valeurs du logiciel libre, nos recettes et les plans de nos machines Ã©tant par exemple publiÃ©s sur notre site web.</p>
<p>Ã€ l&rsquo;Ã©tÃ© 2023 j&rsquo;ai dÃ©cidÃ© de quitter la brasserie pour Ã  la fois refaire du dÃ©veloppement et travailler sur les outils de la prise de dÃ©cision collective, et la gestion des conflits dans les collectifs. C&rsquo;est Ã  ce moment que nous sommes rentrÃ©s en contact avec Luc pour travailler sur Argos.</p>
<h3>Pouvez-vous nous prÃ©senter l&rsquo;outil Argos sur lequel vous avez travaillÃ©&#160;? Ã€ quel besoin rÃ©pond-il pour Framaspace&#160;?</h3>
<p><strong>Alexis&#160;:</strong> Argos est un outil de supervision de sites web. L&rsquo;idÃ©e est assez simple&#160;: surveiller que les sites vont bien, et gÃ©nÃ©rer des alertes quand c&rsquo;est utile, en envoyant des notifications par email ou autre.</p>
<p>La spÃ©cificitÃ© d&rsquo;Argos est de pouvoir gÃ©rer un nombre de sites important. Framaspace, en grossissant, expose pas loin de 900 domaines au public, qui parfois tombent en panne. Je crois que le rÃ©el besoin derriÃ¨re Argos Ã©tait de simplifier la vie de Luc (vous saviez qu&rsquo;il n&rsquo;y avait qu&rsquo;un seul adminsys chez Framasoft&#160;?&#160;!&#160;!) et de lui permettre d&rsquo;avoir une meilleure vision globale de l&rsquo;Ã©tat du service.</p>
<p>Les vÃ©rifications concernent les statuts du site web, mais aussi l&rsquo;Ã©tat des certificats SSL, par exemple, et quelques vÃ©rifications spÃ©cifiques.</p>
<p><strong>Luc&#160;:</strong> On surveillait dÃ©jÃ  plus de 200 sites via notre outil de supervision (Shinken), mais celui-ci, avec toutes les autres sondes de supervision de notre infrastructure, avait bien de la peine Ã  repasser toutes les 5 minutes sur les sites. Ce qui faisait quâ€™on pouvait se rendre compte quâ€™un site Ã©tait tombÃ© au bout de trop de temps.</p>
<p>Avec Framaspace, je savais que jâ€™aurai des centaines (et Ã  terme des milliers) de sites Ã  surveiller en plus, sachant quâ€™un site est la cible de plusieurs vÃ©rifications, comme dit par Alexis. Il fallait donc un outil dÃ©diÃ©.</p>
<p>Les outils existants comme <a href="https://statping-ng.github.io">statping-ng</a> ou <a href="https://uptime.kuma.pet">Uptime Kuma</a> prÃ©sentent un dÃ©faut rÃ©dhibitoire&#160;: vouloir afficher lâ€™Ã©tat de chaque site en mÃªme temps sur lâ€™interface web. Ã‡a va bien quand on a quelques sites, pas quand on en a des centaines (lâ€™outil peine Ã  envoyer les donnÃ©es de centaines de sites).</p>
<p>Câ€™est de lÃ  quâ€™est nÃ©e lâ€™idÃ©e dâ€™Argos, qui a le bon goÃ»t de nâ€™afficher quâ€™un rÃ©sumÃ© de lâ€™Ã©tat des sites par dÃ©faut.</p>
<p>&nbsp;</p>
<div style="width: 998px" class="wp-caption aligncenter"><img loading="lazy" decoding="async" class="transparent shrinkToFit" src="https://asso.framasoft.org/pic/UQoY9fgV/paCVbnU1.png" alt="4 blocs avec des statuts (inconnu, ok, avertissement, erreur) et pour chacun, un nombre correspondant." width="988" height="752" /><p class="wp-caption-text">Capture dâ€™Ã©cran de la page de statut dâ€™Argos</p></div>
<p>&nbsp;</p>
<h3>Si on regarde de plus prÃ¨s les coutures, on voit que c&rsquo;est dÃ©veloppÃ© en langage <a href="https://fr.wikipedia.org/wiki/Python_(langage)"">Python</a> avec une base de donnÃ©es en PostgreSQL. Laissez-moi deviner&#160;: Alexis a choisi Python et Luc a choisi PostgreSQL&#160;?</h3>
<p><strong>Alexis&#160;:</strong> Ah, je vois que tu nous connais un peu, mais figure toi que mÃªme pas&#160;! J&rsquo;aurais aimÃ© plaider coupable pour le coup, mais Luc cherchait spÃ©cifiquement quelqu&rsquo;un qui savait faire du Python, et c&rsquo;est comme Ã§a qu&rsquo;on s&rsquo;est rencontrÃ©. J&rsquo;ai proposÃ© d&rsquo;utiliser le <a href="https://fr.wikipedia.org/wiki/Framework">framework</a> FastAPI Ã  la place de Flask parce que Ã§a nous permettait de faire de l&rsquo;asynchrone de maniÃ¨re plus simple, et d&rsquo;utiliser les fonctionnalitÃ©s de typage de Python.</p>
<p><strong>Luc&#160;:</strong> Pour Framaspace, jâ€™ai Ã©tÃ© plus ou moins obligÃ© de faire du Python car <a href="https://fr.wikipedia.org/wiki/Salt_(logiciel)">Salt</a>, lâ€™orchestrateur utilisÃ© pour dÃ©ployer les espaces est en Python&#160;: je pouvais, en utilisant ce langage, lâ€™utiliser comme une bibliothÃ¨que, sans utiliser de bidouilles sales.</p>
<p>Comme Argos a Ã©tÃ© crÃ©Ã© dans le cadre de Framaspace, jâ€™ai voulu garder le mÃªme langage de programmation, pour avoir un tout cohÃ©rent.</p>
<p>Python nâ€™est pas un langage si pire que Ã§a. Il nâ€™est pas amusant, mais Ã§a fait le job. Peut-Ãªtre aussi que je vieillis&#160;: jâ€™utilise de plus en plus Python pour des scripts. Peut-Ãªtre quâ€™Ã©crire des scripts ne mâ€™amuse plus, et que je veux les Ã©crire vite pour passer Ã  autre chose.</p>
<p><a href="https://framablog.org/wp-content/uploads/2024/05/The_rock_driving_perl_python.jpeg"><img loading="lazy" decoding="async" class="size-medium wp-image-34822 aligncenter" src="https://framablog.org/wp-content/uploads/2024/05/The_rock_driving_perl_python-244x300.jpeg" alt="MÃ¨me the Rock qui conduit - Et ton machin va Ãªtre en Perl, comme d'hab - Non j'ai choisi Python cette fois The rock se retourne, interloquÃ©" width="244" height="300" srcset="https://framablog.org/wp-content/uploads/2024/05/The_rock_driving_perl_python-244x300.jpeg 244w, https://framablog.org/wp-content/uploads/2024/05/The_rock_driving_perl_python.jpeg 500w" sizes="(max-width: 244px) 100vw, 244px" /></a></p>
<h3>La question habituelle de libriste&#160;: pourquoi avez-vous choisi de dÃ©velopper un outil dÃ©diÃ©, il n&rsquo;existait pas d&rsquo;outils libres pour de la supervision&#160;? Quelles sont ses spÃ©cificitÃ©s&#160;?</h3>
<p><strong>Alexis&#160;:</strong> Je te laisse rÃ©pondre Luc, c&rsquo;est toi qui a affinÃ© le besoin&#160;:-)</p>
<p><strong>Luc&#160;:</strong> Ah bah zut, jâ€™ai dÃ©jÃ  rÃ©pondu au-dessus ğŸ˜…</p>
<p>Lâ€™avantage dâ€™avoir notre propre outil nous permet aussi de le tordre pour nos besoins spÃ©cifiques. Ainsi Argos envoie-t-il des notifications Ã  notre serveur <a href="https://gotify.net/">Gotify</a>. IntÃ©grer un tel canal de communication dans un outil existant aurait pu prendre du temps (comprendre le code, faire une PR, attendre une releaseâ€¦).</p>
<h3>En lisant la doc, Ã§a a l&rsquo;air tout simple Ã  utiliser par rapport Ã  d&rsquo;autres outils&#160;!&#160;! Comme administrateurâ‹…ice systÃ¨me du dimanche aprÃ¨s-midi, si je veux surveiller l&rsquo;Ã©tat de mes sites, est-ce qu&rsquo;il y a des piÃ¨ges ou des choses Ã  savoir&#160;?</h3>
<p><strong>Alexis&#160;:</strong> Je pense que Ã§a pourrait tout Ã  fait permettre de surveiller l&rsquo;Ã©tat de quelques sites, bien que peut-Ãªtre surdimensionnÃ©. Argos a besoin de lancer un serveur, une base de donnÃ©es et des agents. Est-ce bien utile pour unâ‹…e adminSys du dimanche&#160;? Peut-Ãªtre&#160;!</p>
<p><strong>Luc&#160;:</strong> Franchement, je pense quâ€™il peut Ãªtre utilisÃ© aussi bien par une grosse organisation que par unÂ·e adminSys du dimanche. La configuration est simple, lâ€™installation pas trÃ¨s compliquÃ©e, et il nâ€™a pas lâ€™air de consommer beaucoup de ressources.</p>
<h3>Alexis tu Ã©tais en mode prestation pour dÃ©velopper, comment s&rsquo;est passÃ©e la relation avec Framasoft&#160;?</h3>
<p><strong>Alexis&#160;:</strong> Franchement, c&rsquo;Ã©tait une surprise totale, et un plaisir du dÃ©but Ã  la fin. On a d&rsquo;abord pu se faire quelques appels avec Luc pour clarifier les besoins, je me suis retrouvÃ© avec une liste de fonctionnalitÃ©s de base, et j&rsquo;ai avancÃ© comme Ã§a.</p>
<p>Quand j&rsquo;avais besoin j&rsquo;ai pu Ã©changer avec Luc qui Ã©tait toujours assez rÃ©actif, et j&rsquo;ai pu lever quelques blocages. J&rsquo;ai beaucoup apprÃ©ciÃ© rÃ©pondre Ã  un besoin concret, en ayant l&rsquo;utilisateur final au bout du fil pour clarifier les choses.</p>
<p>Par la suite, on a pu se faire quelques sessions ensemble, Ã  la fois de prÃ©sentation de l&rsquo;outil, puis de pair-programming pour accompagner Luc sur certains aspects quand c&rsquo;Ã©tait utile, l&rsquo;idÃ©e Ã©tant que ce soit lui qui prenne la main sur le projet.</p>
<p>C&rsquo;Ã©tait en fait ma premiÃ¨re mission en tant que Â«&#160;prestataire&#160;Â», je crois que je suis trÃ¨s bien tombÃ©&#160;!</p>
<p><strong>Luc&#160;:</strong> Pareil de mon cÃ´tÃ©, câ€™Ã©tait trÃ¨s agrÃ©able de bosser avec toi&#160;!</p>
<h3>Est-ce que vous pensez que Ã§a peut Ãªtre utilisÃ© dans d&rsquo;autres contextes que Framaspace&#160;?</h3>
<p><strong>Alexis&#160;:</strong> je pense que Ã§a peut Ãªtre utilisÃ© dans d&rsquo;autres contextes bien sÃ»r. Je pense aux Â«&#160;fermes de sites&#160;Â», comme par exemple ce que peut faire NoBlogs en Allemagne, mais de maniÃ¨re gÃ©nÃ©rale c&rsquo;est utile d&rsquo;avoir un outil simple d&rsquo;accÃ¨s pour faire de la supervision. Bosser lÃ -dessus m&rsquo;a donnÃ© envie de permettre de faire de la supervision Â«&#160;en tant que service&#160;Â», pour des collectifs pour qui ce serait utile, maisâ€¦ j&rsquo;imagine que c&rsquo;est une autre histoire.</p>
<p><strong>Luc&#160;:</strong> CarrÃ©ment&#160;! Pas seulement pour des fermes de sites mais partout oÃ¹ on a besoin dâ€™une supervision qui passe trÃ¨s rÃ©guliÃ¨rement. On peut avoir des vÃ©rifications effectuÃ©es toutes les minutes, ce qui peut Ãªtre utile sur des sites qui ne doivent pas tomber. Et un grand nombre de sites ne devrait pas faire peur Ã  Argos&#160;: on peut multiplier le nombre dâ€™agents (le logiciel qui sâ€™occupe dâ€™effectuer les vÃ©rifications et dâ€™en remonter le rÃ©sultat au serveur), et le choix de PostgreSQL comme base de donnÃ©es a (aussi) Ã©tÃ© fait parce que câ€™est un <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_gestion_de_base_de_donn%C3%A9es"><abbr title="SystÃ¨me de Gestion de Base de DonnÃ©es">SGBD</abbr></a> robuste qui peut encaisser de la charge de travail.</p>
<h3>Et est-ce que vous imaginez une suite, avec une feuille de route ou des invitations Ã  contribuer&#160;?</h3>
<p><strong>Luc&#160;:</strong> Il y a dÃ©jÃ  <a href="https://framagit.org/framasoft/framaspace/argos/-/issues/">des idÃ©es de dÃ©veloppements futurs</a> pour amÃ©liorer Argos, mais Ã§a nâ€™est pas urgent&#160;: la premiÃ¨re version est dÃ©jÃ  tout Ã  fait fonctionnelle.</p>
<p><strong>Alexis&#160;:</strong> J&rsquo;aime bien l&rsquo;idÃ©e de ne pas avoir de feuille de route trop prÃ©cise pour le futur, ce qui nous permet de se concentrer sur des besoins rÃ©els et de ne pas en faire une usine Ã  gaz. Si vous l&rsquo;utilisez et que vous avez des retours Ã  faire, ou bien si vous souhaitez contribuer, n&rsquo;hÃ©sitez pas. C&rsquo;est pensÃ© pour Ãªtre simple Ã  Ã©tendre, donc n&rsquo;hÃ©sitez pas Ã  jeter un Å“il et Ã  proposer des changements.</p>
<h3>Si vous avez encore des choses Ã  dire&#160;:)</h3>
<p><strong>Alexis&#160;:</strong> Coucou Numahell, chouette de te recroiser par ici aprÃ¨s ces quelques annÃ©es&#160;:-)</p>
<p><strong>Luc&#160;:</strong> Merci Ã  toi, Alexis, pour le temps bÃ©nÃ©vole que tu as consacrÃ© Ã  Argos aprÃ¨s ta prestation&#160;!</p>
<h2>Pour aller plus loin</h2>
<ul>
<li><a href="https://framagit.org/framasoft/framaspace/argos">DÃ©pÃ´t</a></li>
<li><a href="https://framasoft.frama.io/framaspace/argos/">Documentation</a></li>
</ul>
